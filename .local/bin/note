#!/usr/bin/env sh

# Note-taking utility
# by David Oniani <onianidavid@gmail.com>
# MIT License

pick() {
    selection=$(fd . --color never --exclude .git --hidden --type f "$1" | fzf --prompt "Note> ")
    [ -z "$selection" ] && exit 0
    $EDITOR "$selection"
}

to_pdf() {
    base="${1%.*}"
    printf "Converting %s to %s ...\n" "$1" "$base.pdf"
    pandoc -V fontsize=11pt \
        -V geometry:margin=1in \
        -V linkcolor:blue \
        -f markdown \
        -t pdf "$1" \
        -o "$base.pdf"
    printf "Saved PDF as %s\n" "$base.pdf"
}

help() {
    printf "usage: note [option]\n\
    pdf convert a note to pdf\n\
    ls  list all notes\n"
}

case $1 in
ls) ls -1 "$2" ;;
pdf) to_pdf "$2" ;;
pick) pick "$2" ;;
*) help ;;
esac
